title = "Radionets Default Training Configuration"

# ─────────────────────────────────────────────────────────────────────────────
# PATHS & I/O
# ─────────────────────────────────────────────────────────────────────────────
[paths]
data_path = "./example_data/"
model_path = "./build/example_model/example.model"
checkpoint = false

# ─────────────────────────────────────────────────────────────────────────────
# MODEL & ARCHITECTURE
# ─────────────────────────────────────────────────────────────────────────────
[model]
arch_name = "SRResNet18"
fourier = true
amp_phase = true
normalize = false

# ─────────────────────────────────────────────────────────────────────────────
# TRAINING
# ─────────────────────────────────────────────────────────────────────────────
[training]
num_epochs = 50
batch_size = 16

[training.loss]
loss_func = "MSELoss"

[training.optimizer]
optimizer = "AdamW"
lr = 0.001

[training.lr_scheduler]
lr_start = 1e-5
lr_max = 5e-3
lr_stop = 1e-7
warmup_ratio = 0.2

# ─────────────────────────────────────────────────────────────────────────────
# ACCELERATORS & DATALOADING
# ─────────────────────────────────────────────────────────────────────────────
[devices]
accelerator = "gpu"
num_devices = "auto"
precision = "32-true"
deepspeed = "deepspeed_stage_2"

[dataloader]
module = "WebDatasetModule"
num_workers = 10
prefetch_factor = 2
persistent_workers = false

# ─────────────────────────────────────────────────────────────────────────────
# CALLBACKS
# ─────────────────────────────────────────────────────────────────────────────
[callbacks.checkpoint]
every_n_epochs = 2
save_top_k = -1

[callbacks.batch_size_finder]
mode = "binsearch"

# ─────────────────────────────────────────────────────────────────────────────
# LOGGING
# ─────────────────────────────────────────────────────────────────────────────
[logging]
project_name = "Radionets Experiment"
plot_n_epochs = 1
scale = true

[logging.comet_ml]
enabled = true

[logging.codecarbon]
log_level = "error"
